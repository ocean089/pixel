<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¹³æ¿æ•¸ç¹”æ•™å­¸</title>
    <style>
        :root {
            --bg-color: #f0f2f5;
            --sidebar-bg: #dde1e7;
            --primary-color: #333;
            --accent-color: #4a90e2;
            --cross-color: #e74c3c;
            --cell-size: 48px; /* å¹³æ¿å‹å–„å°ºå¯¸ */
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            height: 100vh;
            display: flex;
            overflow: hidden; /* é˜²æ­¢æ•´é«”æ²å‹• */
            user-select: none; /* ç¦æ­¢é¸å–æ–‡å­— */
            -webkit-user-select: none;
            touch-action: manipulation; /* å„ªåŒ–è§¸æ§ */
        }

        /* å·¦æ¬„ï¼šæ§åˆ¶å€ */
        .sidebar {
            width: 300px;
            background-color: var(--sidebar-bg);
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            z-index: 10;
        }

        /* å³æ¬„ï¼šéŠæˆ²å€ */
        .game-area {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: white;
            padding: 20px;
            overflow: auto;
        }

        h1 { margin: 0; font-size: 1.5rem; color: var(--primary-color); }
        h2 { margin: 0; font-size: 1.2rem; color: #666; }

        /* æ§åˆ¶å…ƒä»¶æ¨£å¼ */
        select {
            font-size: 1.2rem;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ccc;
            width: 100%;
        }

        .tools {
            display: flex;
            gap: 10px;
        }

        .tool-btn {
            flex: 1;
            padding: 15px;
            font-size: 1.2rem;
            border: 2px solid #ccc;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .tool-btn.active {
            border-color: var(--accent-color);
            background-color: #e6f0fa;
            color: var(--accent-color);
            font-weight: bold;
            box-shadow: 0 0 8px rgba(74, 144, 226, 0.3);
        }

        .action-btn {
            padding: 12px;
            font-size: 1.1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            color: white;
            margin-top: 5px;
        }

        .btn-check { background-color: #27ae60; }
        .btn-reset { background-color: #95a5a6; }

        /* éŠæˆ²ç›¤é¢ (CSS Grid) */
        .board-container {
            display: grid;
            /* å®šç¾©ç¶²æ ¼ï¼šç¬¬ä¸€åˆ—æ˜¯ä¸Šæ–¹æç¤ºï¼Œç¬¬ä¸€æ¬„æ˜¯å·¦æ–¹æç¤º */
            grid-template-columns: auto repeat(5, var(--cell-size));
            grid-template-rows: auto repeat(5, var(--cell-size));
            gap: 2px;
            background-color: #999; /* æ ¼ç·šé¡è‰² */
            border: 2px solid #333;
        }

        /* æç¤ºå€åŸŸ */
        .clue {
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 1rem;
            color: #333;
            line-height: 1.2;
        }

        .clue-col {
            flex-direction: column; /* ä¸Šæ–¹æç¤ºå‚ç›´æ’åˆ— */
            justify-content: flex-end;
            padding-bottom: 5px;
        }
        
        .clue-row {
            justify-content: flex-end; /* å·¦æ–¹æç¤ºé å³å°é½Š */
            padding-right: 8px;
            gap: 5px;
        }

        /* æ ¼å­æ¨£å¼ */
        .cell {
            width: var(--cell-size);
            height: var(--cell-size);
            background-color: #fff;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
        }

        .cell.filled {
            background-color: #2c3e50;
        }

        .cell.crossed::after {
            content: 'Ã—';
            color: var(--cross-color);
            font-weight: bold;
            font-size: 32px;
        }

        /* é ‚è§’ç©ºç™½æ ¼ */
        .corner { background-color: transparent; border: none; }

        /* RWD: æ‰‹æ©Ÿç›´å‘æ™‚æ”¹ç‚ºä¸Šä¸‹æ’åˆ— */
        @media (max-width: 768px) {
            body { flex-direction: column; }
            .sidebar { 
                width: 100%; 
                box-sizing: border-box; 
                flex-direction: row; 
                flex-wrap: wrap; 
                padding: 10px;
                gap: 10px;
            }
            .sidebar > * { flex: 1; min-width: 120px; }
            .tools { width: 100%; }
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <div>
            <h1>æ•¸ç¹”éŠæˆ²</h1>
            <h2>é¸é—œå¡</h2>
        </div>
        
        <select id="levelSelect">
            <option value="0">Level 1: çƒé¾œ (Turtle)</option>
            <option value="1">Level 2: è¸ç‰› (Snail)</option>
            <option value="2">Level 3: è›‡ (Snake)</option>
        </select>

        <div class="tools">
            <button class="tool-btn active" id="btnFill" onclick="setTool('fill')">
                <span>âœï¸</span> å¡—é»‘
            </button>
            <button class="tool-btn" id="btnCross" onclick="setTool('cross')">
                <span>âŒ</span> æ¨™è¨˜
            </button>
        </div>

        <div style="display:flex; flex-direction:column; gap:10px; width:100%;">
            <button class="action-btn btn-check" onclick="checkWin()">æª¢æŸ¥ç­”æ¡ˆ</button>
            <button class="action-btn btn-reset" onclick="resetBoard()">é‡ç½®</button>
        </div>
    </div>

    <div class="game-area">
        <div id="board" class="board-container">
            </div>
    </div>

    <script>
        // é—œå¡æ•¸æ“š
        const levels = [
            {
                name: "Turtle",
                rows: [[1,1,1], [5], [3], [5], [1,1]],
                cols: [[2,2], [3], [4], [3], [2,2]],
                solution: [
                    [1,0,1,0,1], // 1=é»‘, 0=ç™½
                    [1,1,1,1,1],
                    [0,1,1,1,0],
                    [1,1,1,1,1],
                    [1,0,0,0,1]
                ]
            },
            {
                name: "Snail",
                rows: [[0], [2], [1,2], [5], [0]],
                cols: [[2], [1], [3], [3], [1]],
                solution: [
                    [0,0,0,0,0],
                    [1,1,0,0,0],
                    [1,0,1,1,0],
                    [1,1,1,1,1],
                    [0,0,0,0,0]
                ]
            },
            {
                name: "Snake",
                rows: [[5], [1,1], [3,1], [1,1], [3,1]],
                cols: [[3,1], [1,1,1], [1,3], [1], [5]],
                solution: [
                    [1,1,1,1,1],
                    [1,0,0,0,1],
                    [1,1,1,0,1],
                    [1,0,0,0,1],
                    [1,1,1,0,1]
                ]
            }
        ];

        let currentLevelIndex = 0;
        let currentTool = 'fill'; // 'fill' or 'cross'
        let userGrid = []; // å„²å­˜ç©å®¶ç‹€æ…‹: 0=ç©º, 1=é»‘, 2=å‰

        // åˆå§‹åŒ–
        window.onload = () => {
            document.getElementById('levelSelect').addEventListener('change', (e) => {
                loadLevel(e.target.value);
            });
            loadLevel(0);
        };

        function setTool(tool) {
            currentTool = tool;
            document.getElementById('btnFill').classList.toggle('active', tool === 'fill');
            document.getElementById('btnCross').classList.toggle('active', tool === 'cross');
        }

        function loadLevel(index) {
            currentLevelIndex = index;
            const level = levels[index];
            const board = document.getElementById('board');
            board.innerHTML = '';
            
            // åˆå§‹åŒ–ç©å®¶ç¶²æ ¼ (5x5 å…¨0)
            userGrid = Array(5).fill().map(() => Array(5).fill(0));

            // 1. ç”Ÿæˆå·¦ä¸Šè§’ç©ºç™½
            const corner = document.createElement('div');
            corner.className = 'corner';
            board.appendChild(corner);

            // 2. ç”Ÿæˆä¸Šæ–¹æç¤º (Columns)
            level.cols.forEach(clueArr => {
                const cell = document.createElement('div');
                cell.className = 'clue clue-col';
                // éæ¿¾æ‰0ï¼Œæ¯å€‹æ•¸å­—æ›è¡Œ
                cell.innerHTML = clueArr.filter(n=>n>0).join('<br>'); 
                board.appendChild(cell);
            });

            // 3. ç”Ÿæˆåˆ—æç¤º + éŠæˆ²æ ¼å­
            for (let r = 0; r < 5; r++) {
                // å·¦æ–¹æç¤º (Rows)
                const clueCell = document.createElement('div');
                clueCell.className = 'clue clue-row';
                clueCell.innerText = level.rows[r].filter(n=>n>0).join(' ');
                board.appendChild(clueCell);

                // 5å€‹æ ¼å­
                for (let c = 0; c < 5; c++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = r;
                    cell.dataset.col = c;
                    
                    // é»æ“Šäº‹ä»¶
                    cell.addEventListener('pointerdown', () => handleCellClick(r, c, cell));
                    
                    board.appendChild(cell);
                }
            }
        }

        function handleCellClick(r, c, cellElement) {
            const currentState = userGrid[r][c];
            
            if (currentTool === 'fill') {
                // å¦‚æœå·²ç¶“æ˜¯å¡«è‰²ï¼Œå°±å–æ¶ˆï¼›å¦å‰‡å¡«è‰²
                if (currentState === 1) {
                    userGrid[r][c] = 0;
                    cellElement.classList.remove('filled');
                } else {
                    userGrid[r][c] = 1;
                    cellElement.classList.remove('crossed');
                    cellElement.classList.add('filled');
                }
            } else if (currentTool === 'cross') {
                // å¦‚æœå·²ç¶“æ˜¯æ‰“å‰ï¼Œå°±å–æ¶ˆï¼›å¦å‰‡æ‰“å‰
                if (currentState === 2) {
                    userGrid[r][c] = 0;
                    cellElement.classList.remove('crossed');
                } else {
                    userGrid[r][c] = 2;
                    cellElement.classList.remove('filled');
                    cellElement.classList.add('crossed');
                }
            }
        }

        function resetBoard() {
            loadLevel(currentLevelIndex);
        }

        function checkWin() {
            const currentSolution = levels[currentLevelIndex].solution;
            let isCorrect = true;

            for (let r = 0; r < 5; r++) {
                for (let c = 0; c < 5; c++) {
                    // ç©å®¶å¡«é»‘(1) å¿…é ˆç­‰æ–¼ è§£ç­”çš„å¡«é»‘(1)
                    // ç©å®¶æ‰“å‰(2) æˆ– ç©ºç™½(0) éƒ½è¦–ç‚º è§£ç­”çš„ç©ºç™½(0)
                    const playerFilled = userGrid[r][c] === 1;
                    const solutionFilled = currentSolution[r][c] === 1;

                    if (playerFilled !== solutionFilled) {
                        isCorrect = false;
                        break;
                    }
                }
            }

            if (isCorrect) {
                alert("ğŸ‰ æ­å–œï¼ä½ æˆåŠŸè§£é–‹äº†è¬é¡Œï¼");
            } else {
                alert("å†è©¦è©¦çœ‹ï¼Œæœ‰äº›åœ°æ–¹ä¸å¤ªå°å–”ï¼");
            }
        }
    </script>
</body>
</html>
